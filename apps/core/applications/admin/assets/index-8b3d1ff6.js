import{N as e,j as l,t as i,v as r,P as a,n as s,s as d,bs as t,F as n,o as c,L as o,bt as h,c8 as m,w as b,h as p,K as f,c9 as u,ca as C,B as y,cb as g,I as w}from"./index-da778430.js";import{u as v,T as H,G as k,H as I}from"./Header-90427ac0.js";import{g as j}from"./getLibrariesQuery-8f805ce0.js";import{L as x}from"./LibraryIcon-382d25bc.js";import{I as D}from"./Input-94df8f06.js";import{C as L}from"./Checkbox-69de3138.js";import{C as R,D as A}from"./DeleteButton-48c58b6e.js";const _=e`
    mutation DELETE_LIBRARY($libID: ID!) {
        deleteLibrary(id: $libID) {
            id
        }
    }
`,z=({library:e,filters:d})=>{const{t:t}=l(),n=i(),[c]=v(_,{update:(e,{data:{deleteLibrary:l}})=>{r(e,l)}}),o=null!==e.label&&(e.label.fr||e.label.en)||e.id;return n.permissions[a.admin_delete_library]?s(R,{action:async()=>c({variables:{libID:e.id}}),confirmMessage:t("libraries.confirm_delete",{libLabel:o}),children:s(A,{disabled:!!e.system})}):null},B=d(H.Cell)`
    display: flex;
    justify-content: center;
`,E=({libraries:e,onRowClick:i,onFiltersUpdate:r,loading:a,filters:d})=>{const{t:m}=l(),b=t().lang,p=(e,l)=>{"checkbox"===l.type&&!1===d.system&&l.checked&&(l.indeterminate=!0,l.checked=!1),r&&r(l)};return s(n,{children:c(H,{selectable:!0,striped:!0,children:[c(H.Header,{children:[c(H.Row,{children:[s(H.HeaderCell,{width:1}),s(H.HeaderCell,{width:7,children:m("libraries.label")}),s(H.HeaderCell,{width:6,children:m("libraries.ID")}),s(H.HeaderCell,{width:1,children:m("libraries.isSystem")}),s(H.HeaderCell,{width:1})]}),c(H.Row,{className:"filters",children:[s(H.HeaderCell,{}),s(H.HeaderCell,{children:s(D,{size:"small",fluid:!0,placeholder:m("libraries.label")+"...",name:"label",value:d.label||"",onChange:p})}),s(H.HeaderCell,{children:s(D,{size:"small",fluid:!0,placeholder:m("libraries.ID")+"...",name:"id",value:d.id||"",onChange:p})}),s(H.HeaderCell,{children:s(L,{indeterminate:void 0===d.system,name:"system",checked:d.system,onChange:p})}),s(H.HeaderCell,{})]})]}),s(H.Body,{children:a?s(H.Row,{children:s(H.Cell,{colSpan:6,children:s(o,{})})}):e&&e.map((e=>{const l=h(e.label,b);return c(H.Row,{onClick:()=>i(e),children:[s(B,{children:s(x,{library:e})}),s(H.Cell,{children:l}),s(H.Cell,{children:e.id}),s(H.Cell,{children:s(L,{readOnly:!0,checked:!!e.system})}),s(H.Cell,{children:s(z,{library:e,filters:d})})]},e.id)}))})]})})};E.defaultProps={loading:!1,libraries:[],filters:{}};const F=d(I)`
    display: flex;
    align-items: center;
    gap: 0.5rem;
`,P=({history:e})=>{var r;const{t:d}=l(),t=i(),o=m(),[h,v]=b.useState({}),{loading:H,error:I,data:x}=p(j,{variables:{...f(h)}}),D=((null==(r=null==x?void 0:x.libraries)?void 0:r.list)??[]).filter((e=>u(o.currentApp,e.id)));return c(n,{children:[c(k,{children:[s(k.Column,{textAlign:"left",floated:"left",width:8,verticalAlign:"middle",children:c(F,{size:"large",children:[s(C,{size:30}),d("libraries.title")]})}),t.permissions[a.admin_create_library]&&s(k.Column,{floated:"right",width:6,textAlign:"right",verticalAlign:"middle",children:c(y,{primary:!0,icon:!0,labelPosition:"left",size:"medium",as:g,to:"/libraries/edit",children:[s(w,{name:"plus"}),d("libraries.new")]})})]}),void 0!==I?c("p",{children:["Error: ",I.message]}):s(E,{loading:H||!x,libraries:D,onRowClick:l=>e.push("/libraries/edit/"+l.id),onFiltersUpdate:e=>{const l="checkbox"===e.type?e.indeterminate?void 0:e.checked:e.value;v({...h,[e.name]:l})},filters:h})]})};export{P as default};
