import{N as e,j as l,bs as r,t,v as s,bt as i,P as a,n as d,F as n,o as c,L as o,s as h,c8 as m,w as p,h as f,K as u,d8 as C,d9 as g,B as b,cb as y,I as w,E as v}from"./index-da778430.js";import{u as k,T as H,G as x,H as I}from"./Header-90427ac0.js";import{a as j,g as R}from"./getTreesQuery-8499c1fa.js";import{I as D}from"./Input-94df8f06.js";import{C as E}from"./Checkbox-69de3138.js";import{C as T,D as _}from"./DeleteButton-48c58b6e.js";const z=e`
    mutation DELETE_TREE($treeId: ID!) {
        deleteTree(id: $treeId) {
            id
        }
    }
`,A=({tree:e,filters:c})=>{const{t:o}=l(),h=r().lang,m=t(),[p]=k(z,{refetchQueries:[j],update:(e,{data:l})=>{s(e,l.deleteTree)}}),f=i(e.label,h);return e&&m.permissions[a.admin_delete_tree]?d(T,{action:async()=>p({variables:{treeId:e.id}}),confirmMessage:o("trees.confirm_delete",{treeLabel:f}),children:d(_,{disabled:e.system})}):d(n,{})},B=({trees:e,loading:t,filters:s,onFiltersUpdate:a,onRowClick:n})=>{const{t:h}=l(),m=r().lang,p=(e,l)=>{"checkbox"===l.type&&!1===s.system&&l.checked&&(l.indeterminate=!0,l.checked=!1),a&&a(l)};return c(H,{selectable:!0,striped:!0,children:[c(H.Header,{children:[c(H.Row,{children:[d(H.HeaderCell,{width:8,children:h("trees.label")}),d(H.HeaderCell,{width:6,children:h("trees.ID")}),d(H.HeaderCell,{width:1,children:h("trees.isSystem")}),d(H.HeaderCell,{width:1})]}),c(H.Row,{className:"filters",children:[d(H.HeaderCell,{children:d(D,{size:"small",fluid:!0,placeholder:h("trees.label")+"...",name:"label",value:s.label||"",onChange:p})}),d(H.HeaderCell,{children:d(D,{size:"small",fluid:!0,placeholder:h("trees.ID")+"...",name:"id",value:s.id||"",onChange:p})}),d(H.HeaderCell,{children:d(E,{indeterminate:void 0===s.system,name:"system",checked:s.system,onChange:p})}),d(H.HeaderCell,{})]})]}),d(H.Body,{children:t?d(H.Row,{children:d(H.Cell,{colSpan:6,children:d(o,{})})}):e&&e.map((e=>{const l=i(e.label,m);return c(H.Row,{onClick:()=>n(e),children:[d(H.Cell,{children:l}),d(H.Cell,{children:e.id}),d(H.Cell,{children:d(E,{readOnly:!0,checked:!!e.system})}),d(H.Cell,{children:d(A,{tree:e,filters:s})})]},e.id)}))})]})};B.defaultProps={loading:!1,trees:[],filters:{}};const F=h(I)`
    display: flex;
    align-items: center;
    gap: 0.5rem;
`,L=({history:e})=>{var r;const{t:s}=l(),i=m(),[h,k]=p.useState({}),{loading:H,error:I,data:j}=f(R,{variables:{...u(h)}}),D=t(),E=((null==(r=null==j?void 0:j.trees)?void 0:r.list)??[]).filter((e=>C(i.currentApp,e.id)));return c(n,{children:[c(x,{children:[d(x.Column,{textAlign:"left",floated:"left",width:8,verticalAlign:"middle",children:c(F,{size:"large",children:[d(g,{size:30}),s("trees.title")]})}),D.permissions[a.admin_create_tree]&&d(x.Column,{floated:"right",width:6,textAlign:"right",verticalAlign:"middle",children:d(b,{primary:!0,icon:!0,labelPosition:"left",size:"medium",as:y,to:"/trees/edit/",children:c(n,{children:[d(w,{name:"plus"}),s("trees.new")]})})})]}),H&&d(o,{}),I&&d(v,{message:I.message}),!H&&!I&&d(B,{trees:E,onRowClick:l=>e.push("/trees/edit/"+l.id),onFiltersUpdate:e=>{const l="checkbox"===e.type?e.indeterminate?void 0:e.checked:e.value;k({...h,[e.name]:l})},filters:h,loading:H})]})};export{L as default};
